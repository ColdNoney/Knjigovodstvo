<!DOCTYPE html>
<html>
<head>

</head>
<body>

<h1>KNJIGOVODSTVO</h1>
<?php
$servername = "localhost";
$username = "root";
$password = "";
$db_name = "db1";

// Create connection
$conn = new mysqli($servername, $username, $password,$db_name);

// Check connection
if ($conn->connect_error) {
    die("Pogreška pri povezivanju s bazom podataka: " . $conn->connect_error);
} 
echo "Uspješno povezan s bazom podataka!";

?>


<form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>" method="POST">
<br>
Korisničko ime: <input type="text" name="name" ><br>
Lozinka: <input type="password" name="pass"><br>
<input type="submit">
</form>

<?php

$name=$_POST['name'];
$pass=$_POST['pass'];

$nameErr=$passErr="";

if ($_SERVER["REQUEST_METHOD"] == "POST") {
   if (empty($_POST["name"])) {
     $nameErr = "Name is required";
   } else {
     $name = test_input($_POST["name"]);
     // check if name only contains letters and whitespace
     if (!preg_match("/^[a-zA-Z ]*$/",$name)) {
       $nameErr = "Only letters and white space allowed"; 
     }
   }
   
      if (empty($_POST["pass"])) {
     $passErr = "pass is required";
   } else {
     $pass = test_input($_POST["pass"]);
   }
   }
   
   function test_input($data) {
   $data = trim($data);
   $data = stripslashes($data);
   $data = htmlspecialchars($data);
   return $data;
}


$sql = "INSERT INTO korisnik (user, pass)
VALUES ('$name','$pass')";

if ($conn->query($sql) === TRUE) {
    echo "<br>Uspješan unos novog korisnika!";
} else {
    echo "Pogreška: " . $sql . "<br>" . $conn->error;
}

$conn->close();
?>

</body>
</html>
